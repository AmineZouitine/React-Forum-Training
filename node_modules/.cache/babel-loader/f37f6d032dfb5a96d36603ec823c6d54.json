{"ast":null,"code":"'use strict';\n\nconst Url = require('url');\n\nconst Errors = require('./errors');\n\nconst internals = {\n  minDomainSegments: 2,\n  nonAsciiRx: /[^\\x00-\\x7f]/,\n  domainControlRx: /[\\x00-\\x20@\\:\\/]/,\n  // Control + space + separators\n  tldSegmentRx: /^[a-zA-Z](?:[a-zA-Z0-9\\-]*[a-zA-Z0-9])?$/,\n  domainSegmentRx: /^[a-zA-Z0-9](?:[a-zA-Z0-9\\-]*[a-zA-Z0-9])?$/,\n  URL: Url.URL || URL // $lab:coverage:ignore$\n\n};\n\nexports.analyze = function (domain) {\n  let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  if (typeof domain !== 'string') {\n    throw new Error('Invalid input: domain must be a string');\n  }\n\n  if (!domain) {\n    return Errors.code('DOMAIN_NON_EMPTY_STRING');\n  }\n\n  if (domain.length > 256) {\n    return Errors.code('DOMAIN_TOO_LONG');\n  }\n\n  const ascii = !internals.nonAsciiRx.test(domain);\n\n  if (!ascii) {\n    if (options.allowUnicode === false) {\n      // Defaults to true\n      return Errors.code('DOMAIN_INVALID_UNICODE_CHARS');\n    }\n\n    domain = domain.normalize('NFC');\n  }\n\n  if (internals.domainControlRx.test(domain)) {\n    return Errors.code('DOMAIN_INVALID_CHARS');\n  }\n\n  domain = internals.punycode(domain); // https://tools.ietf.org/html/rfc1035 section 2.3.1\n\n  const minDomainSegments = options.minDomainSegments || internals.minDomainSegments;\n  const segments = domain.split('.');\n\n  if (segments.length < minDomainSegments) {\n    return Errors.code('DOMAIN_SEGMENTS_COUNT');\n  }\n\n  if (options.maxDomainSegments) {\n    if (segments.length > options.maxDomainSegments) {\n      return Errors.code('DOMAIN_SEGMENTS_COUNT_MAX');\n    }\n  }\n\n  const tlds = options.tlds;\n\n  if (tlds) {\n    const tld = segments[segments.length - 1].toLowerCase();\n\n    if (tlds.deny && tlds.deny.has(tld) || tlds.allow && !tlds.allow.has(tld)) {\n      return Errors.code('DOMAIN_FORBIDDEN_TLDS');\n    }\n  }\n\n  for (let i = 0; i < segments.length; ++i) {\n    const segment = segments[i];\n\n    if (!segment.length) {\n      return Errors.code('DOMAIN_EMPTY_SEGMENT');\n    }\n\n    if (segment.length > 63) {\n      return Errors.code('DOMAIN_LONG_SEGMENT');\n    }\n\n    if (i < segments.length - 1) {\n      if (!internals.domainSegmentRx.test(segment)) {\n        return Errors.code('DOMAIN_INVALID_CHARS');\n      }\n    } else {\n      if (!internals.tldSegmentRx.test(segment)) {\n        return Errors.code('DOMAIN_INVALID_TLDS_CHARS');\n      }\n    }\n  }\n\n  return null;\n};\n\nexports.isValid = function (domain, options) {\n  return !exports.analyze(domain, options);\n};\n\ninternals.punycode = function (domain) {\n  try {\n    return new internals.URL(`http://${domain}`).host;\n  } catch (err) {\n    return domain;\n  }\n};","map":{"version":3,"names":["Url","require","Errors","internals","minDomainSegments","nonAsciiRx","domainControlRx","tldSegmentRx","domainSegmentRx","URL","exports","analyze","domain","options","Error","code","length","ascii","test","allowUnicode","normalize","punycode","segments","split","maxDomainSegments","tlds","tld","toLowerCase","deny","has","allow","i","segment","isValid","host","err"],"sources":["/home/aminou/React/mon-coter-somber/node_modules/@hapi/address/lib/domain.js"],"sourcesContent":["'use strict';\n\nconst Url = require('url');\n\nconst Errors = require('./errors');\n\n\nconst internals = {\n    minDomainSegments: 2,\n    nonAsciiRx: /[^\\x00-\\x7f]/,\n    domainControlRx: /[\\x00-\\x20@\\:\\/]/,                                                // Control + space + separators\n    tldSegmentRx: /^[a-zA-Z](?:[a-zA-Z0-9\\-]*[a-zA-Z0-9])?$/,\n    domainSegmentRx: /^[a-zA-Z0-9](?:[a-zA-Z0-9\\-]*[a-zA-Z0-9])?$/,\n    URL: Url.URL || URL                                                                 // $lab:coverage:ignore$\n};\n\n\nexports.analyze = function (domain, options = {}) {\n\n    if (typeof domain !== 'string') {\n        throw new Error('Invalid input: domain must be a string');\n    }\n\n    if (!domain) {\n        return Errors.code('DOMAIN_NON_EMPTY_STRING');\n    }\n\n    if (domain.length > 256) {\n        return Errors.code('DOMAIN_TOO_LONG');\n    }\n\n    const ascii = !internals.nonAsciiRx.test(domain);\n    if (!ascii) {\n        if (options.allowUnicode === false) {                                           // Defaults to true\n            return Errors.code('DOMAIN_INVALID_UNICODE_CHARS');\n        }\n\n        domain = domain.normalize('NFC');\n    }\n\n    if (internals.domainControlRx.test(domain)) {\n        return Errors.code('DOMAIN_INVALID_CHARS');\n    }\n\n    domain = internals.punycode(domain);\n\n    // https://tools.ietf.org/html/rfc1035 section 2.3.1\n\n    const minDomainSegments = options.minDomainSegments || internals.minDomainSegments;\n\n    const segments = domain.split('.');\n    if (segments.length < minDomainSegments) {\n        return Errors.code('DOMAIN_SEGMENTS_COUNT');\n    }\n\n    if (options.maxDomainSegments) {\n        if (segments.length > options.maxDomainSegments) {\n            return Errors.code('DOMAIN_SEGMENTS_COUNT_MAX');\n        }\n    }\n\n    const tlds = options.tlds;\n    if (tlds) {\n        const tld = segments[segments.length - 1].toLowerCase();\n        if (tlds.deny && tlds.deny.has(tld) ||\n            tlds.allow && !tlds.allow.has(tld)) {\n\n            return Errors.code('DOMAIN_FORBIDDEN_TLDS');\n        }\n    }\n\n    for (let i = 0; i < segments.length; ++i) {\n        const segment = segments[i];\n\n        if (!segment.length) {\n            return Errors.code('DOMAIN_EMPTY_SEGMENT');\n        }\n\n        if (segment.length > 63) {\n            return Errors.code('DOMAIN_LONG_SEGMENT');\n        }\n\n        if (i < segments.length - 1) {\n            if (!internals.domainSegmentRx.test(segment)) {\n                return Errors.code('DOMAIN_INVALID_CHARS');\n            }\n        }\n        else {\n            if (!internals.tldSegmentRx.test(segment)) {\n                return Errors.code('DOMAIN_INVALID_TLDS_CHARS');\n            }\n        }\n    }\n\n    return null;\n};\n\n\nexports.isValid = function (domain, options) {\n\n    return !exports.analyze(domain, options);\n};\n\n\ninternals.punycode = function (domain) {\n\n    try {\n        return new internals.URL(`http://${domain}`).host;\n    }\n    catch (err) {\n        return domain;\n    }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}